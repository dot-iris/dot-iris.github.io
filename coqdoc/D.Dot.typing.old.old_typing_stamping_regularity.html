<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">D.Dot.typing.old.old_typing_stamping_regularity</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab112"></a><h1 class="section">Show stamped typing only relates stamped syntax.</h1>

Proofs are done on storeless typing. 
</div>
<div class="code">
<span class="comment">(*&nbsp;From&nbsp;D&nbsp;Require&nbsp;Import&nbsp;prelude.<br/>
From&nbsp;D.Dot&nbsp;Require&nbsp;Import&nbsp;type_extraction_syn&nbsp;traversals&nbsp;stampedness_binding&nbsp;closed_subst.<br/>
From&nbsp;D.Dot&nbsp;Require&nbsp;Import&nbsp;storeless_typing&nbsp;old_typing_stamping.<br/>
From&nbsp;D.Dot&nbsp;Require&nbsp;Import&nbsp;ast_stamping&nbsp;path_repl_lemmas.<br/>
Set&nbsp;Implicit&nbsp;Arguments.<br/>
<br/>
Set&nbsp;Suggest&nbsp;Proof&nbsp;Using.<br/>
Set&nbsp;Default&nbsp;Proof&nbsp;Using&nbsp;"Type".<br/>
<br/>
Section&nbsp;storeless_syntyping_lemmas.<br/>
&nbsp;&nbsp;Lemma&nbsp;stamped_mut_subject&nbsp;Γ&nbsp;g&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(∀&nbsp;e&nbsp;T,&nbsp;Γ&nbsp;v⊢ₜ<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">g</span></span> <span class="inlinecode"></span>&nbsp;e&nbsp;:&nbsp;T&nbsp;→&nbsp;is_stamped_tm&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;e)&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(∀&nbsp;ds&nbsp;T,&nbsp;Γ&nbsp;v⊢ds<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">g</span></span> <span class="inlinecode"></span>&nbsp;ds&nbsp;:&nbsp;T&nbsp;→&nbsp;Forall&nbsp;(is_stamped_dm&nbsp;(length&nbsp;Γ)&nbsp;g)&nbsp;(map&nbsp;snd&nbsp;ds))&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(∀&nbsp;l&nbsp;d&nbsp;T,&nbsp;Γ&nbsp;v⊢<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">g</span></span> <span class="inlinecode"></span>{&nbsp;l&nbsp;:=&nbsp;d&nbsp;}&nbsp;:&nbsp;T&nbsp;→&nbsp;is_stamped_dm&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;d).<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;eapply&nbsp;storeless_typing_mut_ind&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(P&nbsp;:=&nbsp;λ&nbsp;Γ&nbsp;g&nbsp;e&nbsp;T&nbsp;_,&nbsp;is_stamped_tm&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;e)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(P0&nbsp;:=&nbsp;λ&nbsp;Γ&nbsp;g&nbsp;ds&nbsp;T&nbsp;_,&nbsp;Forall&nbsp;(is_stamped_dm&nbsp;(length&nbsp;Γ)&nbsp;g)&nbsp;(map&nbsp;snd&nbsp;ds))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(P1&nbsp;:=&nbsp;λ&nbsp;Γ&nbsp;g&nbsp;l&nbsp;d&nbsp;T&nbsp;_,&nbsp;is_stamped_dm&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;d);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clear&nbsp;Γ&nbsp;g;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cbn;&nbsp;intros;&nbsp;try&nbsp;(rewrite&nbsp;&lt;-(@ctx_strip_len&nbsp;Γ&nbsp;Γ')&nbsp;in&nbsp;*;&nbsp;last&nbsp;done);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;by&nbsp;(with_is_stamped&nbsp;inverse&nbsp;+&nbsp;idtac);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eauto&nbsp;using&nbsp;is_unstamped_path2tm,&nbsp;is_stamped_path2tm,&nbsp;is_unstamped_vl_lookup.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;repeat&nbsp;constructor&nbsp;=&gt;&nbsp;//=.&nbsp;by&nbsp;eapply&nbsp;lookup_lt_Some.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;intros;&nbsp;elim:&nbsp;i&nbsp;{s}&nbsp;=&gt;&nbsp;<span class="inlinecode">|<span class="id" title="var">i</span></span> <span class="inlinecode"><span class="id" title="var">IHi</span></span>;&nbsp;rewrite&nbsp;/=&nbsp;?iterate_0&nbsp;?iterate_S&nbsp;//;&nbsp;eauto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;move:&nbsp;e&nbsp;=&gt;&nbsp;<span class="inlinecode"><span class="id" title="var">T'</span></span> <span class="inlinecode">?</span>;&nbsp;ev.&nbsp;by&nbsp;apply&nbsp;@Trav1.trav_dtysem&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(T'&nbsp;:=&nbsp;T')&nbsp;(ts'&nbsp;:=&nbsp;(length&nbsp;σ,&nbsp;g)).<br/>
&nbsp;&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;stamped_exp_subject&nbsp;Γ&nbsp;g&nbsp;e&nbsp;T:&nbsp;Γ&nbsp;v⊢ₜ<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">g</span></span> <span class="inlinecode"></span>&nbsp;e&nbsp;:&nbsp;T&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_tm&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;e.<br/>
&nbsp;&nbsp;Proof.&nbsp;apply&nbsp;stamped_mut_subject.&nbsp;Qed.<br/>
&nbsp;&nbsp;Lemma&nbsp;stamped_path_subject&nbsp;Γ&nbsp;g&nbsp;p&nbsp;T&nbsp;i:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Γ&nbsp;v⊢ₚ<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">g</span></span> <span class="inlinecode"></span>&nbsp;p&nbsp;:&nbsp;T,&nbsp;i&nbsp;→&nbsp;is_stamped_path&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;p.<br/>
&nbsp;&nbsp;Proof.&nbsp;apply&nbsp;stamped_mut_subject.&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;reverse&nbsp;direction&nbsp;slows&nbsp;proof&nbsp;search&nbsp;and&nbsp;isn't&nbsp;used&nbsp;anyway?&nbsp;*)</span><br/>
&nbsp;&nbsp;Lemma&nbsp;is_stamped_ren_ty_1&nbsp;i&nbsp;T&nbsp;g:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;i&nbsp;g&nbsp;T&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;(S&nbsp;i)&nbsp;g&nbsp;(shift&nbsp;T).<br/>
&nbsp;&nbsp;Proof.&nbsp;intros&nbsp;Ht.&nbsp;eapply&nbsp;is_stamped_sub_ty,&nbsp;Ht.&nbsp;auto.&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Local&nbsp;Hint&nbsp;Resolve<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ren_ty_1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_sub_one&nbsp;is_stamped_sub_one_rev<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_nclosed_ty&nbsp;:&nbsp;core.<br/>
<br/>
&nbsp;&nbsp;Hint&nbsp;Extern&nbsp;5&nbsp;(nclosed&nbsp;_&nbsp;_)&nbsp;=&gt;&nbsp;try_once&nbsp;nclosed_ren_inv_ty_one&nbsp;:&nbsp;core.<br/>
&nbsp;&nbsp;Hint&nbsp;Extern&nbsp;5&nbsp;=&gt;&nbsp;try_once&nbsp;nclosed_sub_inv_ty_one&nbsp;:&nbsp;core.<br/>
<br/>
&nbsp;&nbsp;Inductive&nbsp;stamped_ctx&nbsp;g:&nbsp;ctx&nbsp;→&nbsp;Prop&nbsp;:=<br/>
&nbsp;&nbsp;|&nbsp;stamped_nil&nbsp;:&nbsp;stamped_ctx&nbsp;g&nbsp;<span class="inlinecode"></span><br/>
&nbsp;&nbsp;|&nbsp;stamped_cons&nbsp;Γ&nbsp;T:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;Γ&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;(S&nbsp;(length&nbsp;Γ))&nbsp;g&nbsp;T&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;(T&nbsp;::&nbsp;Γ).<br/>
&nbsp;&nbsp;Hint&nbsp;Constructors&nbsp;stamped_ctx&nbsp;:&nbsp;core.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;stamped_nclosed_lookup&nbsp;Γ&nbsp;x&nbsp;T&nbsp;g:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;Γ&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Γ&nbsp;!!&nbsp;x&nbsp;=&nbsp;Some&nbsp;T&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;nclosed&nbsp;(shiftN&nbsp;x&nbsp;T)&nbsp;(length&nbsp;Γ).<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;elim:&nbsp;Γ&nbsp;T&nbsp;x&nbsp;=&gt;&nbsp;//&nbsp;U&nbsp;Γ&nbsp;IHΓ&nbsp;T&nbsp;<span class="inlinecode"><span class="id" title="var">Hs</span></span> <span class="inlinecode">[&lt;-]|<span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">Hs</span></span> <span class="inlinecode"><span class="id" title="var">Hl</span></span>&nbsp;/=;&nbsp;inverse&nbsp;Hs.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;hsubst_id;&nbsp;eauto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;hrenS;&nbsp;eapply&nbsp;nclosed_sub_app,&nbsp;IHΓ;&nbsp;auto.<br/>
&nbsp;&nbsp;Qed.<br/>
&nbsp;&nbsp;Local&nbsp;Hint&nbsp;Resolve&nbsp;stamped_nclosed_lookup&nbsp;:&nbsp;core.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;stamped_lookup&nbsp;Γ&nbsp;x&nbsp;T&nbsp;g:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;Γ&nbsp;→&nbsp;Γ&nbsp;!!&nbsp;x&nbsp;=&nbsp;Some&nbsp;T&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;(shiftN&nbsp;x&nbsp;T).<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;elim:&nbsp;x&nbsp;Γ&nbsp;=&gt;&nbsp;/=&nbsp;<span class="inlinecode">|<span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">IHx</span></span>&nbsp;<span class="inlinecode">|<span class="id" title="var">U</span></span> <span class="inlinecode"><span class="id" title="var">Γ</span></span>&nbsp;/=&nbsp;Hctx&nbsp;Hl;&nbsp;inverse&nbsp;Hctx;&nbsp;simplify_eq.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;by&nbsp;rewrite&nbsp;hsubst_id.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;rewrite&nbsp;hrenS.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apply&nbsp;(@is_stamped_ren_ty_1&nbsp;(length&nbsp;Γ)&nbsp;(shiftN&nbsp;x&nbsp;T)&nbsp;g),&nbsp;IHx;&nbsp;eauto.<br/>
&nbsp;&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;is_stamped_TLater_n&nbsp;{i&nbsp;n&nbsp;T&nbsp;g}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;n&nbsp;g&nbsp;T&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;n&nbsp;g&nbsp;(iterate&nbsp;TLater&nbsp;i&nbsp;T).<br/>
&nbsp;&nbsp;Proof.&nbsp;elim:&nbsp;i&nbsp;=&gt;&nbsp;<span class="inlinecode">|//<span class="id" title="var">i</span></span> <span class="inlinecode"><span class="id" title="var">IHi</span></span>;&nbsp;rewrite&nbsp;?iterate_0&nbsp;?iterate_S&nbsp;//;&nbsp;auto.&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;is_stamped_tv_inv&nbsp;{n&nbsp;v&nbsp;g}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_tm&nbsp;n&nbsp;g&nbsp;(tv&nbsp;v)&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_vl&nbsp;n&nbsp;g&nbsp;v.<br/>
&nbsp;&nbsp;Proof.&nbsp;by&nbsp;inversion&nbsp;1.&nbsp;Qed.<br/>
&nbsp;&nbsp;Lemma&nbsp;is_stamped_TLater_inv&nbsp;{n&nbsp;T&nbsp;g}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;n&nbsp;g&nbsp;(TLater&nbsp;T)&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;n&nbsp;g&nbsp;T.<br/>
&nbsp;&nbsp;Proof.&nbsp;by&nbsp;inversion&nbsp;1.&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Local&nbsp;Hint&nbsp;Resolve&nbsp;is_stamped_tv_inv&nbsp;is_stamped_TLater_n&nbsp;:&nbsp;core.<br/>
&nbsp;&nbsp;Local&nbsp;Hint&nbsp;Extern&nbsp;5&nbsp;(is_stamped_ty&nbsp;_&nbsp;_&nbsp;_)&nbsp;=&gt;&nbsp;try_once&nbsp;is_stamped_TLater_inv&nbsp;:&nbsp;core.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;fmap_TLater_stamped_inv&nbsp;Γ&nbsp;g&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;&gt;&nbsp;Γ&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;Γ.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;elim:&nbsp;Γ&nbsp;=&gt;&nbsp;<span class="inlinecode">//|<span class="id" title="var">T</span></span> <span class="inlinecode"><span class="id" title="var">Γ</span></span> <span class="inlinecode"><span class="id" title="var">IHΓ</span></span>;&nbsp;cbn&nbsp;=&gt;&nbsp;Hs.&nbsp;inverse&nbsp;Hs.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;constructor;&nbsp;first&nbsp;by&nbsp;auto.&nbsp;rewrite&nbsp;-&gt;(fmap_length&nbsp;TLater)&nbsp;in&nbsp;*.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;exact:&nbsp;is_stamped_TLater_inv.<br/>
&nbsp;&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;fmap_TLater_stamped&nbsp;Γ&nbsp;g&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;Γ&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;&gt;&nbsp;Γ.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;elim:&nbsp;Γ&nbsp;=&gt;&nbsp;<span class="inlinecode">//|<span class="id" title="var">T</span></span> <span class="inlinecode"><span class="id" title="var">Γ</span></span> <span class="inlinecode"><span class="id" title="var">IHΓ</span></span>&nbsp;Hs;&nbsp;cbn.&nbsp;inverse&nbsp;Hs.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;constructor;&nbsp;first&nbsp;by&nbsp;auto.&nbsp;rewrite&nbsp;fmap_length.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;exact:&nbsp;(is_stamped_TLater_n&nbsp;(i&nbsp;:=&nbsp;1)).<br/>
&nbsp;&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;ty_strip_stamped&nbsp;n&nbsp;g&nbsp;T&nbsp;T'&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;⊢T&nbsp;T&nbsp;&gt;&gt;▷&nbsp;T'&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;n&nbsp;g&nbsp;T&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;n&nbsp;g&nbsp;T'.<br/>
&nbsp;&nbsp;Proof.&nbsp;induction&nbsp;1;&nbsp;inversion&nbsp;1;&nbsp;auto.&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;ty_sub_stamped&nbsp;n&nbsp;g&nbsp;T&nbsp;T'&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;⊢T&nbsp;T&nbsp;&lt;:&nbsp;T'&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;n&nbsp;g&nbsp;T&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;n&nbsp;g&nbsp;T'.<br/>
&nbsp;&nbsp;Proof.&nbsp;induction&nbsp;1;&nbsp;inversion&nbsp;1;&nbsp;auto.&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;ctx_strip_stamped&nbsp;Γ&nbsp;Γ'&nbsp;g&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;⊢G&nbsp;Γ&nbsp;&gt;&gt;▷*&nbsp;Γ'&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;Γ&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;Γ'.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;induction&nbsp;1;&nbsp;inversion&nbsp;1;&nbsp;subst;&nbsp;constructor;&nbsp;first&nbsp;by&nbsp;auto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;erewrite&nbsp;&lt;-&nbsp;ctx_strip_len;&nbsp;<span class="inlinecode"><span class="id" title="tactic">exact</span>:</span> <span class="inlinecode"><span class="id" title="var">ty_strip_stamped</span>|</span>.<br/>
&nbsp;&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Lemma&nbsp;ctx_sub_stamped&nbsp;Γ&nbsp;Γ'&nbsp;g&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;⊢G&nbsp;Γ&nbsp;&lt;:*&nbsp;Γ'&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;Γ&nbsp;→<br/>
&nbsp;&nbsp;&nbsp;&nbsp;stamped_ctx&nbsp;g&nbsp;Γ'.<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;induction&nbsp;1;&nbsp;inversion&nbsp;1;&nbsp;subst;&nbsp;constructor;&nbsp;first&nbsp;by&nbsp;auto.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;erewrite&nbsp;&lt;-&nbsp;ctx_sub_len;&nbsp;<span class="inlinecode"><span class="id" title="tactic">exact</span>:</span> <span class="inlinecode"><span class="id" title="var">ty_sub_stamped</span>|</span>.<br/>
&nbsp;&nbsp;Qed.<br/>
<br/>
&nbsp;&nbsp;Local&nbsp;Hint&nbsp;Resolve&nbsp;ctx_sub_stamped&nbsp;ctx_strip_stamped&nbsp;fmap_TLater_stamped_inv&nbsp;:&nbsp;core.<br/>
<br/>
&nbsp;&nbsp;Local&nbsp;Hint&nbsp;Resolve&nbsp;stamped_exp_subject&nbsp;stamped_path_subject&nbsp;:&nbsp;core.<br/>
&nbsp;&nbsp;Lemma&nbsp;stamped_mut_types&nbsp;Γ&nbsp;g&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(∀&nbsp;e&nbsp;T,&nbsp;Γ&nbsp;v⊢ₜ<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">g</span></span> <span class="inlinecode"></span>&nbsp;e&nbsp;:&nbsp;T&nbsp;→&nbsp;∀&nbsp;(Hctx:&nbsp;stamped_ctx&nbsp;g&nbsp;Γ),&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T)&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(∀&nbsp;ds&nbsp;T,&nbsp;Γ&nbsp;v⊢ds<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">g</span></span> <span class="inlinecode"></span>&nbsp;ds&nbsp;:&nbsp;T&nbsp;→&nbsp;∀&nbsp;(Hctx:&nbsp;stamped_ctx&nbsp;g&nbsp;Γ),&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T)&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(∀&nbsp;l&nbsp;d&nbsp;T,&nbsp;Γ&nbsp;v⊢<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">g</span></span> <span class="inlinecode"></span>{&nbsp;l&nbsp;:=&nbsp;d&nbsp;}&nbsp;:&nbsp;T&nbsp;→&nbsp;∀&nbsp;(Hctx:&nbsp;stamped_ctx&nbsp;g&nbsp;Γ),&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T)&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(∀&nbsp;p&nbsp;T&nbsp;i,&nbsp;Γ&nbsp;v⊢ₚ<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">g</span></span> <span class="inlinecode"></span>&nbsp;p&nbsp;:&nbsp;T&nbsp;,&nbsp;i&nbsp;→&nbsp;∀&nbsp;(Hctx:&nbsp;stamped_ctx&nbsp;g&nbsp;Γ),&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T)&nbsp;∧<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(∀&nbsp;T1&nbsp;i1&nbsp;T2&nbsp;i2,&nbsp;Γ&nbsp;v⊢ₜ<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">g</span></span> <span class="inlinecode"></span>&nbsp;T1,&nbsp;i1&nbsp;&lt;:&nbsp;T2,&nbsp;i2&nbsp;→&nbsp;∀&nbsp;(Hctx:&nbsp;stamped_ctx&nbsp;g&nbsp;Γ),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T1&nbsp;∧&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T2).<br/>
&nbsp;&nbsp;Proof.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;eapply&nbsp;storeless_typing_mut_ind&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(P&nbsp;:=&nbsp;λ&nbsp;Γ&nbsp;g&nbsp;e&nbsp;T&nbsp;_,&nbsp;∀&nbsp;(Hctx:&nbsp;stamped_ctx&nbsp;g&nbsp;Γ),&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(P0&nbsp;:=&nbsp;λ&nbsp;Γ&nbsp;g&nbsp;ds&nbsp;T&nbsp;_,&nbsp;∀&nbsp;(Hctx:&nbsp;stamped_ctx&nbsp;g&nbsp;Γ),&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(P1&nbsp;:=&nbsp;λ&nbsp;Γ&nbsp;g&nbsp;l&nbsp;d&nbsp;T&nbsp;_,&nbsp;∀&nbsp;(Hctx:&nbsp;stamped_ctx&nbsp;g&nbsp;Γ),&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(P2&nbsp;:=&nbsp;λ&nbsp;Γ&nbsp;g&nbsp;p&nbsp;T&nbsp;i&nbsp;_,&nbsp;∀&nbsp;(Hctx:&nbsp;stamped_ctx&nbsp;g&nbsp;Γ),&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(P3&nbsp;:=&nbsp;λ&nbsp;Γ&nbsp;g&nbsp;T1&nbsp;i1&nbsp;T2&nbsp;i2&nbsp;_,&nbsp;∀&nbsp;(Hctx:&nbsp;stamped_ctx&nbsp;g&nbsp;Γ),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T1&nbsp;∧&nbsp;is_stamped_ty&nbsp;(length&nbsp;Γ)&nbsp;g&nbsp;T2);&nbsp;clear&nbsp;Γ&nbsp;g.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;all:&nbsp;intros;&nbsp;simplify_eq/=;&nbsp;try&nbsp;nosplit&nbsp;inverse&nbsp;Hctx;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;(rewrite&nbsp;-&gt;?(@ctx_sub_len&nbsp;Γ&nbsp;Γ'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?(@ctx_strip_len&nbsp;Γ&nbsp;Γ')&nbsp;in&nbsp;*&nbsp;by&nbsp;assumption);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;(efeed&nbsp;pose&nbsp;proof&nbsp;H&nbsp;;&nbsp;<span class="inlinecode"><span class="id" title="tactic">by</span></span> <span class="inlinecode"><span class="id" title="tactic">eauto</span></span> <span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">ev</span>;</span> <span class="inlinecode"><span class="id" title="tactic">clear</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;(efeed&nbsp;pose&nbsp;proof&nbsp;H0;&nbsp;<span class="inlinecode"><span class="id" title="tactic">by</span></span> <span class="inlinecode"><span class="id" title="tactic">eauto</span></span> <span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">ev</span>;</span> <span class="inlinecode"><span class="id" title="tactic">clear</span></span> <span class="inlinecode"><span class="id" title="var">H0</span></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;constructor;&nbsp;rewrite&nbsp;/=&nbsp;?fmap_length;&nbsp;eauto&nbsp;2;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inverse_is_stamped;&nbsp;eauto&nbsp;4&nbsp;using&nbsp;stamped_lookup,&nbsp;is_stamped_sub_rev_ty.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;eapply&nbsp;unstamped_stamped_type.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;eapply&nbsp;unstamped_stamped_type,&nbsp;is_unstamped_ty_subst.<br/>
&nbsp;&nbsp;Qed.<br/>
End&nbsp;storeless_syntyping_lemmas.&nbsp;*)</span><br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
